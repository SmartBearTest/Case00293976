<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="28d6909a-7bcd-4086-ac90-dbc7c5208ba2" discardOkResults="false" failOnError="false" failTestCaseOnErrors="false" keepSession="false" name="EquipmentStatus TestCase" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" disabled="true" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="28d6909a-7bcd-4086-ac90-dbc7c5208ba2fileName">EquipmentStatus-TestCase</con:setting></con:settings><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="restrequest" name="Authentication" id="031b1e8d-b4d8-4505-96ac-7a314dd5d111"><con:settings/><con:config service="REST Service 5" resourcePath="/webapps/security-spa/api/security/authenticate" methodName="POST" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Authentication" id="eb90dad0-674b-44b3-bf33-7a9456c529b9" mediaType="application/x-www-form-urlencoded" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://javatest.test.com:4035</con:endpoint><con:request>username=test\dccBatch&amp;password=test</con:request><con:originalUri>https://javatest.test.com/webapps/security-spa/api/security/authenticate</con:originalUri><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters/><con:environmentSpec><con:entry environmentId="83e4deb1-38b8-4fd5-9177-2b5359a53f9f"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="6922de35-ae07-4611-8444-4f3641e453ae"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="datasource" name="SpreadSheet" id="7881fc39-07f4-48db-8eba-451ad94f7e4e"><con:settings/><con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSource type="Excel"><con:configuration><file>ProNmSIT_10162017.xlsx</file><worksheet>Main</worksheet><cell>A4</cell><ignoreEmpty>false</ignoreEmpty><evaluateFormulas>false</evaluateFormulas></con:configuration></con:dataSource><con:shared>true</con:shared><con:restartShared>true</con:restartShared><con:property>PRO</con:property><con:property>Status</con:property><con:property>PU Date</con:property><con:property>Type</con:property><con:property>Origin</con:property><con:property>Trailer Scac</con:property><con:property>Trailer</con:property><con:property>Shipper- Name</con:property><con:property>Shipper- Str#</con:property><con:property>Shipper- Phone #</con:property><con:property>Shipper- Number</con:property><con:property>Shipper- Dir1</con:property><con:property>Shipper- Street</con:property><con:property>Shipper- Suf</con:property><con:property>Shipper- Dir2</con:property><con:property>Shipper- Unit</con:property><con:property>Shipper- Type</con:property><con:property>Shipper- City</con:property><con:property>Shipper- State</con:property><con:property>Shipper- Zip</con:property><con:property>Consignee- Name</con:property><con:property>Consignee- Str#</con:property><con:property>Consignee- Phone #</con:property><con:property>Consignee- C/O</con:property><con:property>Consignee- Show</con:property><con:property>Consignee- Booth#</con:property><con:property>Consignee- Number</con:property><con:property>Consignee- Dir1</con:property><con:property>Consignee- Street</con:property><con:property>Consignee- Suf</con:property><con:property>Consignee- Dir2</con:property><con:property>Consignee- Unit</con:property><con:property>Consignee- Type</con:property><con:property>Consignee- City</con:property><con:property>Consignee- State</con:property><con:property>Consignee- Zip</con:property><con:property>Terms</con:property><con:property>GSV</con:property><con:property>NTFY</con:property><con:property>HOMD</con:property><con:property>LFTD</con:property><con:property>ID</con:property><con:property>FAF</con:property><con:property>INTR</con:property><con:property>CBL</con:property><con:property>GBL</con:property><con:property>BOND</con:property><con:property>SIGN</con:property><con:property>QUOTEID</con:property><con:property>PROMO</con:property><con:property>ITEM#</con:property><con:property>G/D</con:property><con:property>REF1 #</con:property><con:property>Ref1 Type</con:property><con:property>Ref2 #</con:property><con:property>Ref2 Type</con:property><con:property>Third Party- Name</con:property><con:property>Third Party- C/O</con:property><con:property>Third Party- Role</con:property><con:property>Third Party- Number</con:property><con:property>Third Party- Dir1</con:property><con:property>Third Party- Street</con:property><con:property>Third Party- Suf</con:property><con:property>Third Party- Dir2</con:property><con:property>Third Party- Unit</con:property><con:property>Third Party- Type</con:property><con:property>Third Party- Store</con:property><con:property>Third Party- City</con:property><con:property>Third Party- State</con:property><con:property>Third Party- Zip</con:property><con:property>NITE</con:property><con:property>FOOD</con:property><con:property>H/U1</con:property><con:property>PKG1</con:property><con:property>WGT1</con:property><con:property>PCS1</con:property><con:property>UOM1</con:property><con:property>CL1</con:property><con:property>NMFC1</con:property><con:property>SUB1</con:property><con:property>CFT1</con:property><con:property>DENS1</con:property><con:property>DESCR1A</con:property><con:property>DESCR1B</con:property><con:property>H/U2</con:property><con:property>PKG2</con:property><con:property>WGT2</con:property><con:property>PCS2</con:property><con:property>UOM2</con:property><con:property>CL2</con:property><con:property>NMFC2</con:property><con:property>SUB2</con:property><con:property>CFT2</con:property><con:property>DENS2</con:property><con:property>DESCR2A</con:property><con:property>DESCR2B</con:property><con:property>H/U3</con:property><con:property>PKG3</con:property><con:property>WGT3</con:property><con:property>PCS3</con:property><con:property>UOM3</con:property><con:property>CL3</con:property><con:property>NMFC3</con:property><con:property>SUB3</con:property><con:property>CFT3</con:property><con:property>DENS3</con:property><con:property>DESCR3A</con:property><con:property>DESCR3B</con:property><con:property>STC/SLC</con:property><con:completeLastOperation>true</con:completeLastOperation><con:restartOnRun>true</con:restartOnRun></con:config></con:testStep><con:testStep type="jdbc" name="EquipmentStatusLegacyDB" id="105fe3b0-f68c-458e-b17c-fc5b3cee488a"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>Legacy</con:dbConnectionName><con:driver>com.microsoft.sqlserver.jdbc.SQLServerDriver</con:driver><con:connectionString>jdbc:sqlserver://Ywsqltest\Legacy;databaseName=Legacy_SA;integratedSecurity= true</con:connectionString><con:password/><con:connectionProperties/><con:query>select w.WGP_ID_NBR as Pro_NB,
es.New_EQP_ACTVTY_STATUS as Equipment_Status_Type_CD,
es.Door_Cd,  
e.Equipment_Unit_Nb as To_Equipment_Unit_Nb,  
x.ORZ_RFRNC_CD as DestTerminal
from  [Ywsqlltest\legacy].legacy_sa.Eqp.Equipment_VW e
left join [Ywsqlltest\legacy].legacy_sa.Eqp.Equipment_Status_VW es 
on (es.M204_Equipment_Tag_ID= e.M204_Equipment_Tag_ID) 
and es.Equipment_Status_TS = (Select MAX(es2.Equipment_Status_TS) 
From [Ywsqlltest\legacy].legacy_sa.EQP.Equipment_Status_VW es2 WITH (NOLOCK) 
where es.Standard_Carrier_Alpha_CD = es2.Standard_Carrier_Alpha_CD
AND es.Equipment_Unit_NB = es2.Equipment_Unit_NB)
left join [Ywsqlltest\legacy].legacy_sa.[Legacy].[M204_WGP] w  on w.TWG_TO_EQP_TAG =e.M204_Equipment_Tag_ID
left join [Ywsqlltest\legacy].legacy_sa.[Legacy].[M204_XORZ] x on w.WGP_PLANNED_DEST_ORZ_TAG=x.ORZ_RFRNC_CD
where  w.WGP_ID_NBR = '${SpreadSheet#PRO}' 
Order By es.Equipment_Status_TS desc, es.Equipment_Status_System_TS desc
</con:query><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="EquipmentStatusBDD" id="6d4c819d-a1db-4074-8079-ca4f93832c81"><con:settings><con:setting id="prettyPrintResponse">true</con:setting></con:settings><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>BDD</con:dbConnectionName><con:driver>com.microsoft.sqlserver.jdbc.SQLServerDriver</con:driver><con:connectionString>jdbc:sqlserver://Ywsqltest\ads;databaseName=OPS_SA;integratedSecurity= true</con:connectionString><con:password/><con:connectionProperties/><con:query>select s.PRO_NB,s.Shipment_key,e.M204_Equipment_TAG_ID,es.Equipment_Status_Type_CD, es.[Door_CD] ,s.To_Equipment_Unit_NB, f.[Facility_CD] as DestTerminal  from Ship. Shipment s
left outer join [EQP].[Facility_VW] f on (f.[Facility_KEY] = s.Planned_Destination_Facility_KEY)
left outer join [EQP].[Equipment_VW] e on (e.[Equipment_Unit_NB] = s.[To_Equipment_Unit_NB])
left outer join [EQP].[Equipment_Status_VW] es on (es.[Equipment_Status_Key] = e.[Equipment_Status_KEY])
where s.PRO_NB = '5525045040' </con:query><con:properties/></con:config></con:testStep><con:testStep type="request" name="MIDAF-EquipmentStatus" id="20dba760-462d-4766-b17e-1b3a64fd5e45"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>wsdl_getPackageInfo_Binder</con:interface><con:operation>MIDAF</con:operation><con:request name="MIDAF-EquipmentStatus" id="b3a5b619-f30e-4a89-a2da-70ddf4bb6b7f"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://satest-trust.ago.test.com/ida900?prmUser=CRMUSER</con:endpoint><con:request><![CDATA[<dataInput>
<hdr>
  <programId>IDA200.XML</programId>
  <Form>1</Form>
  <fgInd>f</fgInd>
  <file>EQP</file>
  <action>retrieval</action>
  <subAction>none</subAction>
</hdr>
<selection>
  <field>
    <name>EQP.TAG</name>
    <value>2EQP0902220554175633</value>
    <operator>eq</operator>
  </field>
</selection>
</dataInput>]]></con:request><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/><con:environmentSpec><con:entry environmentId="83e4deb1-38b8-4fd5-9177-2b5359a53f9f"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="6922de35-ae07-4611-8444-4f3641e453ae"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:request></con:config></con:testStep><con:testStep type="restrequest" name="QuintinqEquipmentStatus" id="5496d27a-c381-4a83-8d4c-89c24f2e070e"><con:settings/><con:config service="REST Service 2" resourcePath="/citypd/api/v1/shipment/" methodName="GET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="QuintinqEquipmentStatus" id="284aa5fa-3ffc-4002-9aa3-5acaca493059" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://sb-sita.test.com</con:endpoint><con:request/><con:originalUri>http://sb-sita.test.com/citypd/api/v1/shipment/</con:originalUri><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="shipmentKey" value="2469121" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:environmentSpec><con:entry environmentId="83e4deb1-38b8-4fd5-9177-2b5359a53f9f"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="6922de35-ae07-4611-8444-4f3641e453ae"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="datasink" name="EquipmentStatus" id="141b6f3f-206d-4749-b237-f27ac3c4762e"><con:settings/><con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dataSink type="Excel"><con:configuration><file>EquipmentStatusTestResult.xlsx</file><outfile>EquipmentStatusTestResult.xlsx</outfile><worksheet>Sheet1</worksheet><cell>A2</cell><evaluateFormulas>false</evaluateFormulas><append>false</append></con:configuration></con:dataSink><con:properties><con:property><con:name>ExcelPro</con:name><con:value>${SpreadSheet#PRO}</con:value></con:property><con:property><con:name>BDDRecordkey</con:name><con:value>${EquipmentStatusBDD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/WGP_RECORD_KEY[1]}</con:value></con:property><con:property><con:name>LegacyRecordKey</con:name><con:value>${EquipmentStatus#LegacyRecordKey}</con:value></con:property><con:property><con:name>M204RecordKey</con:name><con:value>${MIDAF-EquipmentStatus#RawResponse}</con:value></con:property><con:property><con:name>BDDAccesorialCD</con:name><con:value>${EquipmentStatusBDD#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/ACCESSORIAL_ITEM_CD[1]}</con:value></con:property><con:property><con:name>LegacyAccesorialCD</con:name><con:value>${EquipmentStatusLegacyDB#ResponseAsXml#//Results[1]/ResultSet[1]/Row[1]/TBL_CDWRD[1]}</con:value></con:property><con:property><con:name>M204AccesorialCD</con:name><con:value/></con:property><con:property><con:name>QuintiqAccesorialCD</con:name><con:value>${QuintinqEquipmentStatus#ResponseAsXml#declare namespace ns1='http://sb-sita.test.com/citypd/api/v1/shipment/'; //ns1:Response[1]/ns1:infoStatusList[1]/ns1:e[2]/ns1:propertyValue[1]}</con:value></con:property><con:property><con:name>Status</con:name><con:value>${=testRunner.runTestStepByName("MIDAF-TBLAccesorial").getStatus()}</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="REST Request" id="274818ab-c8cc-4031-aa38-c244b60cad47"><con:settings/><con:config service="REST Service 3" resourcePath="/citypd/api/v1/equipment" methodName="GET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="REST Request" id="0ba567fe-0367-428f-89a0-7969d54a14df" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://sb-sita.test.com</con:endpoint><con:request/><con:originalUri>http://sb-sita.test.com/citypd/api/v1/equipment</con:originalUri><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters/><con:environmentSpec><con:entry environmentId="83e4deb1-38b8-4fd5-9177-2b5359a53f9f"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="6922de35-ae07-4611-8444-4f3641e453ae"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:testStep type="datasourceloop" name="Iterate" id="ac7eef7e-142f-4be1-8534-351daab87950"><con:settings/><con:config><dataSourceStep>SpreadSheet</dataSourceStep><targetStep>EquipmentStatusLegacyDB</targetStep></con:config></con:testStep><con:testStep type="restrequest" name="REST Request 2" id="53730007-050e-4f42-b6d9-5a37d75476ec" disabled="true"><con:settings/><con:config service="REST Service 4" resourcePath="/citypd/api/v1/equipment" methodName="GET" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="REST Request 2" id="c98d8e4d-cb28-4e9d-b540-5032a22b88e3" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://sb-sita.test.com</con:endpoint><con:request/><con:originalUri>http://sb-sita.test.com/citypd/api/v1/equipment</con:originalUri><con:credentials><con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters/><con:environmentSpec><con:entry environmentId="83e4deb1-38b8-4fd5-9177-2b5359a53f9f"><con:authProfile>Inherit From Parent</con:authProfile></con:entry><con:entry environmentId="6922de35-ae07-4611-8444-4f3641e453ae"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:restRequest></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>274818ab-c8cc-4031-aa38-c244b60cad47</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>031b1e8d-b4d8-4505-96ac-7a314dd5d111</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:environmentSpec><con:entry environmentId="6922de35-ae07-4611-8444-4f3641e453ae"><con:authProfile>Inherit From Parent</con:authProfile></con:entry></con:environmentSpec></con:testCase>